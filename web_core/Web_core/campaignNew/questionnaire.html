<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>问卷调查</title>
    <link href="../Content/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/jquery-ui.css"/>
    <link rel="stylesheet" href="css/evol-colorpicker.min.css"/>
    <link rel="stylesheet" href="../Content/bootstrap/summernote/summernote.css"/>
    <link rel="stylesheet" href="../Content/bootstrap/css/bootstrap-theme.css"/>
    <link rel="stylesheet" href="../Content/bootstrap/css/bootstrap-datetimepicker.min.css"/>
    <link rel="stylesheet" href="../Content/bootstrap/css/bootstrap-switch.css"/>
    
    <link rel="stylesheet" href="../Content/bootstrap/css/cropper.min.css"/>
    <link href="../Content/Style/standard.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/campaignEdit-ui.css"/>
    <link rel="stylesheet" href="css/base.css"/>
    <link href="../Content/bootstrap/css/font-awesome.min.css" rel="stylesheet" />

</head>
<style>
    .appendInfo .evo-colorind{
      float:initial;
    }
</style>
<body>
<div class="wrapper"></div>
<div class="main-edit" style="display:none">
  <div class="qus-title"><h1 class="title-content">问卷调查</h1></div>
  <div class="qus-prefix"><div class="prefix-content">为了给您提供更好的服务，希望您能抽出几分钟时间，将您的感受和建议告诉我们，我们非常重视每位客户的宝贵意见，感谢您的参与！</div></div>
	<div class="que-wrapper">  
	  <div data-que-main class="que-container">
<!-- 	      <div class="que-main que-control-radio">
	          <div class="que-control">
	             <div class="qtitle">
	              <span class="qtitle-require">*</span>
	              <span class="qtitle-index">1</span>
	              <span class="qtitle-text">请输入题目</span>
	             </div>
	          </div>
	          
	          <div class="qinputs">
	             <div class="qinputs-item"><input type="radio"><label>选项一</label></div>
	             <div class="qinputs-item"><input type="radio"><label>选项二</label></div>
	             <div class="qinputs-item"><input type="radio"><label>选项二</label></div>
	             <div class="qinputs-item"><input type="radio"><label>选项二</label></div>
	          </div>
	          
	          <div class="controls">
	             <ul> 
	             <li class="control_btn edit">
	                 <b title="编辑"><i class="iconfont">&#xe7aa;</i>编辑</b>
	             </li> 
	             <li class="control_btn copy">
	                 <b title="复制"><i class="iconfont">&#xe7ad;</i>复制</b>
	             </li> 
	             <li class="control_btn logic">
	                 <b title="设置逻辑"><i class="iconfont">&#xe7ac;</i>逻辑</b>
	             </li> 
	             <li class="control_btn delete">
	                 <b title="删除"><i class="iconfont">&#xe7ab;</i>删除</b>
	             </li> 
	             </ul> 
	          </div>
	      </div>
	      <div class="que-main que-control-checkbox">
	          <div class="que-control que-control-radio">
	             <div class="qtitle">
	              <span class="qtitle-require">*</span>
	              <span class="qtitle-index">1</span>
	              <span class="qtitle-text">请输入题目</span>
	             </div>
	          </div>
	          <div class="qinputs">
	             <div class="qinputs-item"><input type="radio"><label>选项一</label></div>
	             <div class="qinputs-item"><input type="radio"><label>选项二</label></div>
	             <div class="qinputs-item"><input type="radio"><label>选项二</label></div>
	             <div class="qinputs-item"><input type="radio"><label>选项二</label></div>
	          </div>
	          <div class="controls">
	             <ul> 
	             <li class="control_btn edit">
	                 <b title="编辑"><i class="iconfont">&#xe7aa;</i>编辑</b>
	             </li> 
	             <li class="control_btn copy">
	                 <b title="复制"><i class="iconfont">&#xe7ad;</i>复制</b>
	             </li> 
	             <li class="control_btn logic">
	                 <b title="设置逻辑"><i class="iconfont">&#xe7ac;</i>逻辑</b>
	             </li> 
	             <li class="control_btn delete">
	                 <b title="删除"><i class="iconfont">&#xe7ab;</i>删除</b>
	             </li> 
	             </ul> 
	          </div>
	      </div>
	      <div class="que-main que-control-select">
	          <div class="que-control ">
	             <div class="qtitle">
	              <span class="qtitle-require">*</span>
	              <span class="qtitle-index">1</span>
	              <span class="qtitle-text">请输入题目</span>
	             </div>
	          </div>
	          <div class="qinputs">
	             <select name="qinputs-item" class="qinputs-item"> 
		             <option value="">--请选择--</option>  
		             <option id="" value="o-100-ABCD" class=""> 选项 </option>  
		             <option id="" value="o-101-EFGH" class=""> 选项 </option>  
	             </select>
	          </div>
	          <div class="controls">
	             <ul> 
	             <li class="control_btn edit">
	                 <b title="编辑"><i class="iconfont">&#xe7aa;</i>编辑</b>
	             </li> 
	             <li class="control_btn copy">
	                 <b title="复制"><i class="iconfont">&#xe7ad;</i>复制</b>
	             </li> 
	             <li class="control_btn logic">
	                 <b title="设置逻辑"><i class="iconfont">&#xe7ac;</i>逻辑</b>
	             </li> 
	             <li class="control_btn delete">
	                 <b title="删除"><i class="iconfont">&#xe7ab;</i>删除</b>
	             </li> 
	             </ul> 
	          </div>
	      </div>
	      <div class="que-main que-control-input">
	          <div class="que-control ">
	             <div class="qtitle">
	              <span class="qtitle-require">*</span>
	              <span class="qtitle-index">1</span>
	              <span class="qtitle-text">请输入题目</span>
	             </div>
	          </div>
	          <div class="qinputs">
	             <input class="form-control qinputs-item">
	          </div>
	          <div class="controls">
	             <ul> 
	             <li class="control_btn edit">
	                 <b title="编辑"><i class="iconfont">&#xe7aa;</i>编辑</b>
	             </li> 
	             <li class="control_btn copy">
	                 <b title="复制"><i class="iconfont">&#xe7ad;</i>复制</b>
	             </li> 
	             <li class="control_btn logic">
	                 <b title="设置逻辑"><i class="iconfont">&#xe7ac;</i>逻辑</b>
	             </li> 
	             <li class="control_btn delete">
	                 <b title="删除"><i class="iconfont">&#xe7ab;</i>删除</b>
	             </li> 
	             </ul> 
	          </div>
	      </div>
	      <div class="que-main que-control-textarea">
	          <div class="que-control">
	             <div class="qtitle">
	              <span class="qtitle-require">*</span>
	              <span class="qtitle-index">1</span>
	              <span class="qtitle-text">请输入题目</span>
	             </div>
	          </div>
	          <div class="qinputs">
	             <textarea class="form-control qinputs-item"></textarea>
	          </div>
	          <div class="controls">
	             <ul> 
	             <li class="control_btn edit">
	                 <b title="编辑"><i class="iconfont">&#xe7aa;</i>编辑</b>
	             </li> 
	             <li class="control_btn copy">
	                 <b title="复制"><i class="iconfont">&#xe7ad;</i>复制</b>
	             </li> 
	             <li class="control_btn logic">
	                 <b title="设置逻辑"><i class="iconfont">&#xe7ac;</i>逻辑</b>
	             </li> 
	             <li class="control_btn delete">
	                 <b title="删除"><i class="iconfont">&#xe7ab;</i>删除</b>
	             </li> 
	             </ul> 
	          </div>
	      </div>
	      <div class="que-main que-control-description">
	          <div class="que-control">
	             <div class="qtitle">
	              <span class="qtitle-require">*</span>
	              <span class="qtitle-index">1</span>
	              <span class="qtitle-text">请输入题目</span>
	             </div>
	          </div>
	          <div class="qinputs">
	             <p>这段是说明题</p>
	          </div>
	          <div class="controls">
	             <ul> 
	             <li class="control_btn edit">
	                 <b title="编辑"><i class="iconfont">&#xe7aa;</i>编辑</b>
	             </li> 
	             <li class="control_btn copy">
	                 <b title="复制"><i class="iconfont">&#xe7ad;</i>复制</b>
	             </li> 
	             <li class="control_btn logic">
	                 <b title="设置逻辑"><i class="iconfont">&#xe7ac;</i>逻辑</b>
	             </li> 
	             <li class="control_btn delete">
	                 <b title="删除"><i class="iconfont">&#xe7ab;</i>删除</b>
	             </li> 
	             </ul> 
	          </div>
	      </div> -->
	      <!-- 编辑状态 -->
	      <!-- <div class="que-main-edit">
	          <div class="qeue-control que-control-radio">
	             <div class="qetitle">
	              <span class="qetitle-text">题目</span>
	              <div class="qetitle-content"><input class="form-control" type="text"></div>
	              <label> 
	                 <input name="qe_required" style="margin-right: 0;" type="checkbox" checked=""> 
	              必填
	              </label>
	             </div>
	          </div>
	          <div class="qeinputs">
	             <div class="qeinputs-item"><input class="form-control" type="text"><span class="iconfont qeinputs-item-remove">&#xe75e;</span></div>
	             <div class="qeinputs-item"><input class="form-control" type="text"><span class="iconfont qeinputs-item-remove">&#xe75e;</span></div>
	             <div class="qeinput-item-add"><span class="iconfont">&#xe75f;</span></div>
	          </div>
	          <div class="qeControls-btns">
		          <button class="btn commonBtn revert qeControls-btns-cancel" type="reset">取消</button> 
		          <button type="button" class="btn commonBtn qeControls-btns-save">保存</button>
	          </div>
	      </div> -->
	  </div>
	  <div class="que-type">
         <div class="que-type-title">添加问题</div>
         <div id="que-menu">
            <div class="menu-item que-type-radio"><span class="iconfont">&#xe7ae;</span>单选题</div>
            <div class="menu-item que-type-checkbox"><span class="iconfont">&#xe7af;</span>多选题</div>
            <div class="menu-item que-type-select"><span class="iconfont">&#xe7b8;</span>下拉题</div>
            <div class="menu-item que-type-input"><span class="iconfont">&#xe7b1;</span>单行题</div>
            <div class="menu-item que-type-textarea"><span class="iconfont">&#xe7b2;</span>多行题</div>
            <div class="menu-item que-type-description"><span class="iconfont">&#xe7b0;</span>说明题</div>
         </div>
      </div>
  </div>
</div>
<div class="main-config" style="display:none">
   <div class="recovery-control">
     <div class="recovery-title">回收设置</div>
     <div class="recovery-main">
	     <div class="row">
	        <div class="recovery-main-title">
	        <div class="recovery-main-switch">
	            <input class='tgl tgl-light endTimeSwitch' id='cb1' type='checkbox'>
                <label class='tgl-btn' for='cb1'></label>
	        </div>
	        <span>设置问卷结束时间</span>
	        </div>
	        <div class="recovery-main-title">
	        <input class="form-control endTime" placeholder="选择问卷开始时间"  style="display:none">
	        <!--<div class="recovery-main-switch">
	            <input class='tgl tgl-light' id='cb2' type='checkbox'>
                <label class='tgl-btn' for='cb2'></label>
	        </div>
	        <span>回答提醒（有新回答时可获得短信通知）</span>-->
	        </div>
	     </div>
     </div>
   </div>
   <div class="user-control">
   <div class="user-title">用户信息</div>
     <div class="user-main">
	     <div class="row">
	        <div class="user-main-title">
		        <div class="user-main-switch">
		            <input class='tgl tgl-light formAppletSwitch' id='cb3' type='checkbox'>
	                <label class='tgl-btn' for='cb3'></label>
		        </div>
		       <span>提交问卷需填写用户信息</span> 
	        </div>
	        
	        <div class="user-fill-inputs" style="display:none">
	          <!-- <label><input type="radio" name="userInput">姓名/电话</label>
	          <label><input type="radio" name="userInput">姓名/电话/邮箱</label> -->
	        </div>
	     </div>
     </div>
   </div>
</div>
<div class="main-endPage" style="display:none">
   <div id="end_summernote"></div>
</div>

<!-- logic-modal -->
<div class="modal fade" id="logicConfigModal" tabindex="-1" role="dialog" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">逻辑设置</h4>
      </div>
      <div class="modal-body">
        <div class="logic-left">
           <div class="logic-left-title">当用户选择本题选项</div>
           <div class="logic-left-options">
             <ul>
                <!-- <li class="logic-left-option">选项一</li>
                <li class="logic-left-option">选项二</li>
                <li class="logic-left-option">选项三</li> -->
             </ul>
           </div>
        </div>
        <div class="logic-right">
           <div class="logic-right-title"><span>•</span>则显示以下题目</div>
           <div class="logic-right-quesitons">
             <ul>
                <!-- <li class="logic-right-option">选项一</li>
                <li class="logic-right-option">选项二</li>
                <li class="logic-right-option">选项三</li> -->
             </ul>
           </div>
           <div class="logix-right-goto"><input type="radio">跳转至：结束页</div>
        </div>
        <div class="clear"></div>
      </div>
      
      <div class="modal-footer">        
        <button type="button" class="btn closebtn" data-dismiss="modal">取消</button>
        <button type="button" class="btn commonBtn comfirmBtn">
          确认</button>
      </div>
    </div>
  </div>
</div><!-- modal-end -->
<!-- wxpreview-modal -->
<div class="modal fade" id="wxPreviewModal" tabindex="-1" role="dialog" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">微信预览</h4>
      </div>
      <div class="modal-body">
           <div class="wxqrcode" style="text-align: center;"></div>
      </div>
      
      <div class="modal-footer">        
        <button type="button" class="btn closebtn" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div><!-- modal-end -->
<!-- delete-modal -->
<div class="modal fade" id="deleteQuestionModal" tabindex="-1" role="dialog" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">提示</h4>
      </div>
      <div class="modal-body">
           <div class="" style="text-align: center;">确认要删除此问题吗？</div>
      </div>
      
      <div class="modal-footer">        
        <button type="button" class="btn closebtn" data-dismiss="modal">关闭</button>
        <button type="button" class="btn error confirmDelete" data-dismiss="modal">确认</button>
      </div>
    </div>
  </div>
</div><!-- modal-end -->
<script src="../Content/JS/jquery-1.9.1.js"></script>
<!--<script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script>-->
<script src="js/jquery-ui.min.js"></script>
<script src="js/extend/evol-colorpicker.min.js"></script>
<script src="../Content/bootstrap/js/bootstrap.min.js"></script>
<script src="../Content/bootstrap/js/bootstrap-datetimepicker.min.js"></script>
<script src="../Content/bootstrap/locale/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="../Content/bootstrap/js/bootstrap-switch.js"></script>
<script src="../Content/JS/iptools_v2.js"></script>
<script src="js/tag-it.js"></script>
<script src="../Content/bootstrap/summernote/summernote_v2.js"></script>
<script src="../Content/bootstrap/summernote/lang/summernote-zh-CN.js"></script>
<script src="../Content/bootstrap/js/cropper.min.js"></script>
<script src="../Content/JS/ipComponents.js"></script>
<script src="../campaignInfo/js/act-common.js" type="text/javascript" charset="utf-8"></script>
<script src="js/shortcutActivity-base.js" type="text/javascript"></script>
<script src="js/extend/dragula.min.js"></script>
<script src="js/extend/lodash.min.js"></script>
<script type="text/javascript" src="js/extend/jquery.qrcode.min.js"></script> 
<script src="js/questionnarie.js" type="text/javascript"></script>
<script type="text/javascript">
//初始化外框架
component.initCampaignBaseDom({"container":".wrapper",
	"campaignTypeName":"问卷调查",
	"tabNameArr":["问卷编辑","设置","结束页"]});
	
$("#tab0-panel").html($(".main-edit").html());
$("#tab1-panel").html($(".main-config").html());
$("#tab2-panel").html($(".main-endPage").html());

$(".contactTabList").append('<span class="uploadBgImg iconfont"><input id="bgphoto" type="file" style="opacity: 0;cursor: pointer;font-size: 22px;width: 50px;">&#xe759;</span>');
widget.init();
//拖拽
var words = document.querySelector('[data-que-main]');
document.addEventListener('DOMContentLoaded', function () {
    var drag = dragula([
        words
    ]);
    drag.on("drop",function(el){
    	//如果拖拽之前的逻辑就删除
    	var r=confirm("移动之后设置的逻辑将会移除")
   	  if (r==true){
	   		debugger
	   		var qid = $(el).attr("data-qid");
	   		var qType = widget.getQuestionTypeBy$dom($(el));
	   		var itemId = $(el).attr("data-surveyid");
	   		//设置此问题的初始是否隐藏
	   		//widget.showQuestionByItemId(itemId);
	   		if(qType == "radio"||qType == "checkbox"){
	   			var choices = $(el).find(".qinputs-item");
	   			for(var i = 0;i<choices.length;i++){
	   				var cid = $(choices[i]).attr("cid");
	   		   		widget.deleteLogicByChoiceId(cid);
	   			}
	   		}else if(qType == "select"){
	   			var opts = $(el).find(".qinputs-item option:not(.defaultVal)");
	   			for(var i = 0;i<opts.length;i++){
	   				var cid = $(opts[i]).val();
	   		   		widget.deleteLogicByChoiceId(cid);
	   			}
	   		}
   	  		
   	  	    //维护全局变量
   			//删除跳转到此题的选项关系
	    	$.each(widget.DEFAULT.questionObj[""+qid],function(j,jval){
	    		widget.DEFAULT.questionObj[""+qid][""+j]={};
		    })
	    sortQuestion();
	 	widget.phonePreview();
   	  }else{
   	    return false;
   	  }
    })
}); 
//重新排序问题list
function sortQuestion(){
	var questions = $("#tab0-panel .que-container .que-main");
	for(var i = 0;i <questions.length;i++){
        //说命题不排序
        if($(questions[i]).hasClass("que-control-description")){
            continue;
        }else{
            $(questions[i]).find(".qtitle-index").html(i+1);
        }
	}
}

</script>
</body>
</html>